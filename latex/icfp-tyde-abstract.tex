\documentclass[sigplan,screen,authordraft]{acmart}

% https://icfp22.sigplan.org/home/tyde-2022#Call-for-Papers

% TODO: check https://authors.acm.org/proceedings/production-information/accepted-latex-packages
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{stmaryrd}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{agda}
\usepackage{natbib}
\usepackage{todonotes} % TODO: remove at the end

\citestyle{acmauthoryear}

\usepackage{newunicodechar}
\newunicodechar{∀}{\ensuremath{\mathnormal\forall}}
\newunicodechar{⊤}{\ensuremath{\mathnormal\top}}
\newunicodechar{⊥}{\ensuremath{\mathnormal\bot}}
\newunicodechar{≡}{\ensuremath{\mathnormal\equiv}}
\newunicodechar{ᵇ}{\ensuremath{\mathnormal{}^b}}
\newunicodechar{ℕ}{\ensuremath{\mathnormal\mathbf{N}}}
\newunicodechar{∅}{\ensuremath{\mathnormal\emptyset}}
\newunicodechar{⊆}{\ensuremath{\mathnormal\subseteq}}
\newunicodechar{∪}{\ensuremath{\mathnormal\cup}}
\newunicodechar{∷}{\ensuremath{\mathnormal::}}
\newunicodechar{⟦}{\ensuremath{\mathnormal\llbracket}}
\newunicodechar{⟧}{\ensuremath{\mathnormal\rrbracket}}
\newunicodechar{⌊}{\ensuremath{\mathnormal\lfloor}}
\newunicodechar{⌋}{\ensuremath{\mathnormal\rfloor}}
\newunicodechar{Γ}{\ensuremath{\mathnormal\Gamma}}
\newunicodechar{σ}{\ensuremath{\mathnormal\sigma}}
\newunicodechar{τ}{\ensuremath{\mathnormal\tau}}
\newunicodechar{Δ}{\ensuremath{\mathnormal\Delta}}
\newunicodechar{₁}{\ensuremath{\mathnormal{}_1}}
\newunicodechar{₂}{\ensuremath{\mathnormal{}_2}}

\include{generated/Lang}
\include{generated/Subset}
\include{generated/Recursion}
\include{generated/Live}

\newcommand{\Draft}[1]{{\color{gray} - #1}}
%\newcommand{\Todo}[1]{}
\newcommand{\Todo}[1]{\todo[inline]{TODO: #1}}

\title{Provingly Correct Optimizations in an Intrinsically Typed Compiler (Extended Abstract)}

\keywords{agda, compiler, program optimization}

\author{Matthias Heinzel}
\affiliation{%
  \institution{Utrecht University}
  \city{Utrecht}
  \country{Netherlands}}
\email{m.h.heinzel@students.uu.nl}

\date{\today}

\begin{document}

\maketitle
\Todo{Wouter as second author?}

\section{Introduction}

When writing a compiler for a functional programming language,
one of the core considerations usually is the treatment of binders and variables.
\Draft{many possible representations (string, de Bruijn)}
\Draft{naive implementation is not scope-safe, therefore partial}

A well-known technique when using dependently typed programming languages such as Agda
\cite{norell2007agda}
is to define an intrinsically typed syntax tree \cite{augustsson1999intrinsic}.
\Draft{correct by construction, scope- and type-safe, total evaluator}
This construction has featured in several papers exploring
compilation to different target languages
\cite{todo-calculating-correct-compilers} % TODO
as well as basic operations like renaming and substitution
\cite{todo-type-and-scope-safe-universe-of-bindings}. % TODO

However, there has been little focus on performing optimizations on the syntax tree.
\Draft{optimizations are important, correctness often not trivial}

While the search for optimization opportunities is mostly unaffected
by the presence of additional type information,
performing any transformation of the program now comes with the burden of
convincing the compiler of its type- and scope-safety.
\Draft{especially when related to binders}
\Draft{also, analysis results need to be in form that allows proving correctness}

For any given set of language features, there is a large number of potentially relevant optimizations.
We will consider a very simple expression language with binders,
making the optimizations widely applicable.
\Todo{Not sure how to plug the Nielsen book here.}
\Todo{This reads a bit awkwardly, maybe there's a better justification.}

As a specific instance, we present an implementation of \emph{dead binding elimination}
by defining a syntax tree annotated with variable usage information.
We further show that the optimization is semantics-preserving,
independently of how the annotations are obtained.
\Todo{The last bit does not seem clear.
In LVA, the annotated expression type is expressive enough
that the definition of \texttt{analyse} is basically forced,
but generally it could have more freedom, e.g. to use heuristics for inlining,
and its implementation would not matter for optimization correctness.}


\section{An Expression Language with Binders}
\Todo{Merge into some other section? Show Agda definition here?}


\section{Dead Binding Elimination}

\subsection{Live Variable Analysis}
\cite{chapman2009type}

\subsection{Correctness}

\subsection{Iterating the Optimization}
\cite{bove2016recursion}


\bibliographystyle{ACM-Reference-Format}
\bibliography{bibliography}{}

\end{document}
