\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{stmaryrd}
\usepackage{listings}
\usepackage{agda}

\usepackage{newunicodechar}
\newunicodechar{∀}{\ensuremath{\mathnormal\forall}}
\newunicodechar{⊤}{\ensuremath{\mathnormal\top}}
\newunicodechar{⊥}{\ensuremath{\mathnormal\bot}}
\newunicodechar{≡}{\ensuremath{\mathnormal\equiv}}
\newunicodechar{ᵇ}{\ensuremath{\mathnormal{}^b}}
\newunicodechar{ℕ}{\ensuremath{\mathnormal\mathbf{N}}}
\newunicodechar{∅}{\ensuremath{\mathnormal\emptyset}}
\newunicodechar{⊆}{\ensuremath{\mathnormal\subseteq}}
\newunicodechar{∪}{\ensuremath{\mathnormal\cup}}
\newunicodechar{∷}{\ensuremath{\mathnormal::}}
\newunicodechar{⟦}{\ensuremath{\mathnormal\llbracket}}
\newunicodechar{⟧}{\ensuremath{\mathnormal\rrbracket}}
\newunicodechar{⌊}{\ensuremath{\mathnormal\lfloor}}
\newunicodechar{⌋}{\ensuremath{\mathnormal\rfloor}}
\newunicodechar{Γ}{\ensuremath{\mathnormal\Gamma}}
\newunicodechar{σ}{\ensuremath{\mathnormal\sigma}}
\newunicodechar{τ}{\ensuremath{\mathnormal\tau}}
\newunicodechar{Δ}{\ensuremath{\mathnormal\Delta}}
\newunicodechar{₁}{\ensuremath{\mathnormal{}_1}}
\newunicodechar{₂}{\ensuremath{\mathnormal{}_2}}

\include{generated/Lang}
\include{generated/Subset}
\include{generated/Recursion}
\include{generated/Live}

% TODO: proper title
% goal of report: summary of main results
\title{Provingly Correct Optimizations in an Intrinsically Typed Compiler\\
  \vspace{1cm}
  \large Experimentation Project Report}
\author{Matthias Heinzel (1632256)}
\date{\today}

\begin{document}

\maketitle
\tableofcontents


\section{Introduction}
% ?
% others worked on compilation of intrinsically typed AST
% but not a lot on optimizations in this setting
% handling bindings in a way the compiler accepts requires some care


\section{A Simple Language}

\subsection{Simply-typed $\lambda$-calculus}
% simply typed lambda calculus
%  but fist order, i.e. no lambda  TODO: how else to call that?

\begin{align*}
  P, Q ::=&\ v
  \\ \big|&\ P + Q
  \\ \big|&\ \textbf{let } x = P \textbf{ in } Q
  \\ \big|&\ x
\end{align*}

\subsection{Representing Variables}
% open/closed terms
% de Bruijn

\subsection{Intrinsically Typed Syntax Trees}
% some representations are error-prone/partial
% typed Ctx
% representation correct by construction

\CodeLangSyntax


\section{Live Variable Analysis}
% want to annotate terms with variables actually used
% then remove unused bindings

\subsection{Subsets of a Context}
% TODO: call it thinning? cite something, e.g. McBride?
% why this representation?
%   subset relation/proof on Subsets is unique (compare e.g. [NAT] \subseteq [NAT, NAT]
%   union-like operation is definable

\CodeSubsetSubset
\CodeSubsetOpSubseteq

\subsection{Analysis}
% a lot is encoded in the annotated LiveExpr type

\CodeLiveExpr

\subsection{Correctness}
% relate by evaluation
% split the proof
% subtlety: evaluate under which environment
% subtlety: irrelevant arguments

\subsection{Iterating the Analysis}
% optimization might make other bindings unused
% could be done in one pass here, but gets complex
% => take a fixpoint! termination?
% Well-Founded recursion


\section{Further Work}

\subsection{Extending the Language}
% Lam+App, short sketch
% recursion
% data types (product/sum)
% pointers?

\subsection{Other Analyses}
% inlining
%   more difficult to encode goal, take list of what to inline
% move bindings to top or as far down as possible

\end{document}
